<%- include('partials/head.ejs') %>
<%- include('partials/navbar.ejs') %>

<div class="container main-container py-4">
    <div class="address-container">

        <div class="header">Delivery Address</div>
        <div class="content p-4 border border-2" productName="<%=product.title%>">
            <form id="edit-form " action="" method="post" class="form-group new-address-form">

                <div class="form-floating my-2">
                    <input name="addressLine" type=" text" class="form-control w-100"
                        id="addressLine" placeholder="Username" required>
                    <label for="addressLine" class=" form-label">Address Line</label>
                </div>
                <div class="form-floating my-2">
                    <input name="fullname" type=" text" class="form-control w-100" id="fullname"
                        placeholder="Username" required>
                    <label for="fullname" class=" form-label">Full Name</label>
                </div>
                <div class="input-group my-2">

                    <div class="form-floating">
                        <input name="city" type="text" class="form-control" placeholder="City"
                            id="city" required>
                        <label for=" city" class="form-label">City</label>
                    </div>
                    <div class="form-floating">
                        <input name="state" type="text" class="form-control" placeholder="Surname"
                            id="state" required>
                        <label for="state" class="form-label">State</label>
                    </div>
                </div>



                <div class="input-group my-2 ">

                    <div class="form-floating">
                        <input name="phone" type="number" class="form-control w-100"
                            placeholder="Phone" id="phone" required>
                        <label for="phone" class="form-label">Phone</label>
                    </div>


                    <div class="form-floating mb-3">
                        <input name="postalCode" type="number" class="form-control w-100"
                            placeholder="Postal Code" id="postalCode" required>
                        <label for="postalCode" class="form-label">Postal Code</label>
                    </div>


                </div>







                <button class="sign-up-btn shadow-sm new-address-btn" type="submit">Add and Use</button>

            </form>
           <h5 class="mt-4 pt-4 ">Add Existing</h5>
           <% addresses.forEach(elt => { %>
            
            <div class="address-card p-2 ps-3 shadow-sm my-2 border existing-address" addressId="<%= elt._id %>" >
                <h5><%= elt.fullname %></h5>
                <h6><%= elt.addressLine %></h6>
                <h6><%= elt.city %></h6>
                <h6><%= elt.state %></h6>
                <h6><%= elt.postalCode %></h6>
                <h6><%= elt.phone %></h6>
                
            </div>
            <% }) %>
        </div>
    </div>
    <div class="checkout-container border border-2 " productId="<%=product._id%>" price="<%=request.amount%>" userId="<%=product.userId%>">
            <div class="img-container">
                <img class="list-card-img" src="data:image/;base64,<%=product.images[0].toString('base64') || ''%>"
                alt="Title">                
            </div>

            <div class="details d-flex-col ps-4 pt-4 border border-bottom">
                <h3 class="mb-0">₹<%= request.amount%></h3>
                <h4 class="p-2 ps-0"><b><%= product.title%></b></h4>
                <div class="d-flex mt-2 justify-content-between px-4 ps-0">

                    <h5 class=""><%= product.location%></h5>
                    <h5><%= product.createdAt%></h5>
                </div>

            </div>
            <div class="px-2 mt-4 ">
                <table class="table">
                    
                    
                    <tbody >
                      <tr >
                        <th scope="row">Amount</th>
                        <td>₹<%=request.amount%></td>
                      </tr>
                      <tr>
                        <th scope="row">Transaction Fee (1%)</th>
                        <td>₹<%=request.amount*0.01%></td>
                      </tr>
                      <tr class="my-2">
                        <th scope="row">Total</th>
                        <td><%=request.amount + (request.amount*0.01)%></td>
                      </tr>
                    </tbody>
                  </table>
                  <button class="px-4 py-1 my-2 mb-4 on-click-btn default-black-btn" navLink style="width: 15rem; height: 3rem; margin-left: 28%;" id="order-btn">Place Order</button>
            </div>
    </div>


</div>

<script src="/js/checkout.js"></script>
<script src="/js/landing.js"></script>
<%- include('partials/closingHead.ejs') %>